{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Upload","Result","styled","div","H1","h1","Image","img","Component","observer","useStores","ImageStore","UserStore","ref1","useRef","ref2","store","useLocalStore","width","height","serverFile","attributes","url","widthStr","heightStr","setHeight","setWidth","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","message","warning","window","test","type","size","error","upload","then","console","log","catch","tip","spinning","isUploading","className","InboxOutlined","target","href","filename","src","ref","onChange","current","value","placeholder","fullStr","Tips","children","Uploader"],"mappings":"6OAQOA,EAAWC,IAAXD,QAEDE,EAASC,IAAOC,IAAV,+FAKNC,EAAKF,IAAOG,GAAV,sEAIFC,EAAQJ,IAAOK,IAAV,iDA6GIC,EAxGGC,aAAS,WACvB,MAAgCC,cAAzBC,EAAP,EAAOA,WAAYC,EAAnB,EAAmBA,UACbC,EAAOC,mBAAUC,EAAOD,mBAExBE,EAAQC,aAAc,iBAAO,CACjCC,MAAO,KACPC,OAAQ,KACR,eACE,OAAOH,EAAME,MAAN,aAAoBF,EAAME,OAAU,IAE7C,gBACE,OAAOF,EAAMG,OAAN,aAAqBH,EAAMG,QAAW,IAE/C,cACE,OAAOR,EAAWS,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAkBN,EAAMO,SAAWP,EAAMQ,WAExGC,UAZiC,SAYvBN,GACRH,EAAMG,OAASA,GAEjBO,SAfiC,SAexBR,GACPF,EAAME,MAAQA,OAUZS,EAAQ,CACZC,gBAAgB,EAChBC,aAAc,SAAAC,GAGZ,OAFAnB,EAAWoB,QAAQD,GACnBnB,EAAWqB,YAAYF,EAAKG,MACC,MAAzBrB,EAAUsB,aACZC,IAAQC,QAAQ,+CACT,IAGTC,OAAOP,KAAOA,EAGT,wCAAwCQ,KAAKR,EAAKS,MAInDT,EAAKU,KAAO,SACdL,IAAQM,MAAM,2CACP,IAET9B,EAAW+B,SACRC,MAAK,SAACvB,GACHwB,QAAQC,IAAI,+BAEdC,OAAM,kBAAMF,QAAQC,IAAI,gCACrB,IAZLV,IAAQM,MAAM,8EACP,MAeb,OACE,gCACE,cAAC,IAAD,CAAMM,IAAI,qBAAMC,SAAUrC,EAAWsC,YAArC,SACE,eAAClD,EAAD,2BAAa4B,GAAb,cACE,mBAAGuB,UAAU,uBAAb,SACE,cAACC,EAAA,EAAD,MAEF,mBAAGD,UAAU,kBAAb,0EACA,mBAAGA,UAAU,kBAAb,uHAMFvC,EAAWS,WACT,eAACnB,EAAD,WACE,cAACG,EAAD,uCACA,+BACE,0DACA,6BAAI,mBAAGgD,OAAO,SACPC,KAAM1C,EAAWS,WAAWC,WAAWC,IAAID,WAAWC,IADzD,SAC+DX,EAAWS,WAAWC,WAAWC,IAAID,WAAWC,QAEnH,oDACA,6BAAKX,EAAW2C,WAChB,0DACA,6BACE,cAAChD,EAAD,CAAOiD,IAAK5C,EAAWS,WAAWC,WAAWC,IAAID,WAAWC,QAE9D,0DACA,+BACE,uBAAOkC,IAAK3C,EAAM4C,SAlER,WACtBzC,EAAMU,SAASb,EAAK6C,QAAQC,QAiE6BC,YAAY,qDACzD,uBAAOJ,IAAKzC,EAAM0C,SAhEP,WACvBzC,EAAMS,UAAUV,EAAK2C,QAAQC,QA+D6BC,YAAY,wDAE5D,6BACE,mBAAGR,OAAO,SAASC,KAAMrC,EAAM6C,QAA/B,SAAyC7C,EAAM6C,kBAGzC,WCpHlBC,EAAO5D,IAAOC,IAAV,mIASKM,eAAS,YAAiB,IAAfsD,EAAc,EAAdA,SAEjBnD,EAAaF,cAAbE,UAEP,OACE,mCACGA,EAAUsB,YAAc,KAAO,cAAC4B,EAAD,UAAOC,SCd9BtD,uBAAS,WACFC,cAAbE,UAEP,OACE,qCACE,cAAC,EAAD,yDACA,cAACoD,EAAD","file":"static/js/9.7ee6c9c5.chunk.js","sourcesContent":["import React, {useRef} from 'react'\nimport {useStores} from '../stores'\nimport {observer, useLocalStore} from 'mobx-react'\nimport {InboxOutlined} from '@ant-design/icons'\nimport {Upload, message, Spin} from 'antd'\nimport styled from 'styled-components'\nimport image from '../stores/image'\n\nconst {Dragger} = Upload\n\nconst Result = styled.div`\n  margin-top: 30px;\n  border: 1px dashed #ccc;\n  padding: 20px;\n`\nconst H1 = styled.h1`\n  margin: 20px 0;\n  text-align: center;\n`\nconst Image = styled.img`\n  max-width: 300px;\n`\n\n\nconst Component = observer(() => {\n    const {ImageStore, UserStore} = useStores()\n    const ref1 = useRef(), ref2 = useRef()\n    // 返回值要加个括号，不然会被理解为函数体\n    const store = useLocalStore(() => ({\n      width: null,\n      height: null,\n      get widthStr() {\n        return store.width ? `/w/${store.width}` : ''\n      },\n      get heightStr() {\n        return store.height ? `/h/${store.height}` : ''\n      },\n      get fullStr() {\n        return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\n      },\n      setHeight(height) {\n        store.height = height\n      },\n      setWidth(width) {\n        store.width = width\n      },\n    }))\n\n    const bindWidthChange = () => {\n      store.setWidth(ref1.current.value)\n    }\n    const bindHeightChange = () => {\n      store.setHeight(ref2.current.value)\n    }\n    const props = {\n      showUploadList: false,\n      beforeUpload: file => {\n        ImageStore.setFile(file)\n        ImageStore.setFilename(file.name)\n        if (UserStore.currentUser == null) {\n          message.warning('请先登陆再上传')\n          return false\n        }\n        // 可以在控制台看到文件的api\n        window.file = file\n\n        // .ig是指忽略大小写\n        if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/ig.test(file.type)) {\n          message.error('只能上传.png/.gif/.jpg/.svg格式的图片')\n          return false\n        }\n        if (file.size > 1024 * 1024) {\n          message.error('最大上传1M图片')\n          return false\n        }\n        ImageStore.upload()\n          .then((serverFile) => {\n              console.log('上传成功')\n            }\n          ).catch(() => console.log('上传失败'))\n        return false\n      }\n    }\n\n    return (\n      <div>\n        <Spin tip='上传中' spinning={ImageStore.isUploading}>\n          <Dragger {...props}>\n            <p className=\"ant-upload-drag-icon\">\n              <InboxOutlined/>\n            </p>\n            <p className=\"ant-upload-text\">点击或者拖拽上传图片</p>\n            <p className=\"ant-upload-hint\">\n              仅支持.png/.gif/.jpg/.svg格式的图片，图片最大1M\n            </p>\n          </Dragger>\n        </Spin>\n        {\n          ImageStore.serverFile ?\n            <Result>\n              <H1>上传结果</H1>\n              <dl>\n                <dt>线上地址</dt>\n                <dd><a target=\"_blank\"\n                       href={ImageStore.serverFile.attributes.url.attributes.url}>{ImageStore.serverFile.attributes.url.attributes.url}</a>\n                </dd>\n                <dt>文件名</dt>\n                <dd>{ImageStore.filename}</dd>\n                <dt>图片预览</dt>\n                <dd>\n                  <Image src={ImageStore.serverFile.attributes.url.attributes.url}/>\n                </dd>\n                <dt>更多尺寸</dt>\n                <dd>\n                  <input ref={ref1} onChange={bindWidthChange} placeholder=\"最大宽度（可选）\"/>\n                  <input ref={ref2} onChange={bindHeightChange} placeholder=\"最大高度（可选）\"/>\n                </dd>\n                <dd>\n                  <a target=\"_blank\" href={store.fullStr}>{store.fullStr}</a>\n                </dd>\n              </dl>\n            </Result> : null\n        }\n      </div>\n    )\n  }\n)\n\nexport default Component","import React from 'react'\nimport {useStores} from '../stores/index'\nimport {observer} from 'mobx-react'\nimport styled from 'styled-components'\n\nconst Tips = styled.div`\n  background: orange;\n  color: #fff;\n  border-radius: 4px;\n  padding: 10px;\n  margin: 30px 0;\n  \n`\n\nexport default observer(({children}) => {\n  // eslint-disable-next-line no-unused-vars\n  const {UserStore} = useStores()\n\n  return (\n    <>\n      {UserStore.currentUser ? null : <Tips>{children}</Tips>}\n    </>\n  )\n})","import React from 'react'\nimport {observer} from 'mobx-react'\nimport {useStores} from '../stores'\nimport Uploader from '../components/Uploader'\nimport Tips from '../components/Tips'\n\nexport default observer(() => {\n  const {UserStore} = useStores()\n  const User = () => <>Hello~{UserStore.currentUser.attributes.username}</>\n  return (\n    <>\n      <Tips>请先登陆在上传</Tips>\n      <Uploader />\n    </>\n  )\n}\n)\n\n\n\n"],"sourceRoot":""}