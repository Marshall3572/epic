{"ast":null,"code":"import _initializerDefineProperty from\"/Users/marshall/Desktop/epic-react/epic/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/initializerDefineProperty\";import _classCallCheck from\"/Users/marshall/Desktop/epic-react/epic/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/marshall/Desktop/epic-react/epic/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _applyDecoratedDescriptor from\"/Users/marshall/Desktop/epic-react/epic/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor\";import _initializerWarningHelper from\"/Users/marshall/Desktop/epic-react/epic/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/initializerWarningHelper\";var _class,_descriptor,_descriptor2,_descriptor3,_descriptor4;import React from'react';import{observable,action,makeObservable}from'mobx';import{Uploader}from'../models';import{message}from'antd';var ImageStore=(_class=/*#__PURE__*/function(){function ImageStore(){_classCallCheck(this,ImageStore);_initializerDefineProperty(this,\"filename\",_descriptor,this);_initializerDefineProperty(this,\"file\",_descriptor2,this);_initializerDefineProperty(this,\"isUploading\",_descriptor3,this);_initializerDefineProperty(this,\"serverFile\",_descriptor4,this);makeObservable(this);}_createClass(ImageStore,[{key:\"setFilename\",value:function setFilename(newFilename){this.filename=newFilename;}},{key:\"setFile\",value:function setFile(newFile){this.file=newFile;}},{key:\"upload\",value:function upload(){var _this=this;this.isUploading=true;// 若上传失败，上传结果展示的还是上次的结果，会让人产生误会，所以每次上传都清空一下\nthis.serverFile=null;return new Promise(function(resolve,reject){Uploader.add(_this.file,_this.filename).then(function(serverFile){_this.serverFile=serverFile;resolve(serverFile);}).catch(function(err){message.error('上传失败');reject(err);}).finally(function(){_this.isUploading=false;});});}},{key:\"reset\",value:function reset(){this.isUploading=false;this.serverFile=null;}}]);return ImageStore;}(),(_descriptor=_applyDecoratedDescriptor(_class.prototype,\"filename\",[observable],{configurable:true,enumerable:true,writable:true,initializer:function initializer(){return'';}}),_descriptor2=_applyDecoratedDescriptor(_class.prototype,\"file\",[observable],{configurable:true,enumerable:true,writable:true,initializer:function initializer(){return null;}}),_descriptor3=_applyDecoratedDescriptor(_class.prototype,\"isUploading\",[observable],{configurable:true,enumerable:true,writable:true,initializer:function initializer(){return false;}}),_descriptor4=_applyDecoratedDescriptor(_class.prototype,\"serverFile\",[observable],{configurable:true,enumerable:true,writable:true,initializer:function initializer(){return null;}}),_applyDecoratedDescriptor(_class.prototype,\"setFilename\",[action],Object.getOwnPropertyDescriptor(_class.prototype,\"setFilename\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"setFile\",[action],Object.getOwnPropertyDescriptor(_class.prototype,\"setFile\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"upload\",[action],Object.getOwnPropertyDescriptor(_class.prototype,\"upload\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"reset\",[action],Object.getOwnPropertyDescriptor(_class.prototype,\"reset\"),_class.prototype)),_class);// export { UserStore } 不能直接这么写，最好是直接导出一个对象\nexport default new ImageStore();","map":{"version":3,"sources":["/Users/marshall/Desktop/epic-react/epic/src/stores/image.js"],"names":["React","observable","action","makeObservable","Uploader","message","ImageStore","newFilename","filename","newFile","file","isUploading","serverFile","Promise","resolve","reject","add","then","catch","err","error","finally"],"mappings":"s5BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAAQC,UAAR,CAAoBC,MAApB,CAA4BC,cAA5B,KAAiD,MAAjD,CACA,OAAQC,QAAR,KAAuB,WAAvB,CACA,OAAQC,OAAR,KAAsB,MAAtB,C,GAEMC,CAAAA,U,iCACJ,qBAAc,0RACZH,cAAc,CAAC,IAAD,CAAd,CACD,C,kDAOD,qBAAoBI,WAApB,CAAiC,CAC/B,KAAKC,QAAL,CAAgBD,WAAhB,CACD,C,uBAED,iBAAgBE,OAAhB,CAAyB,CACvB,KAAKC,IAAL,CAAYD,OAAZ,CACD,C,sBAED,iBAAiB,gBACf,KAAKE,WAAL,CAAmB,IAAnB,CACA;AACA,KAAKC,UAAL,CAAkB,IAAlB,CAEA,MAAO,IAAIC,CAAAA,OAAJ,CAAY,SAACC,OAAD,CAAUC,MAAV,CAAqB,CACtCX,QAAQ,CAACY,GAAT,CAAa,KAAI,CAACN,IAAlB,CAAwB,KAAI,CAACF,QAA7B,EAAuCS,IAAvC,CAA4C,SAAAL,UAAU,CAAI,CACxD,KAAI,CAACA,UAAL,CAAkBA,UAAlB,CACAE,OAAO,CAACF,UAAD,CAAP,CACD,CAHD,EAGGM,KAHH,CAGS,SAAAC,GAAG,CAAI,CACdd,OAAO,CAACe,KAAR,CAAc,MAAd,EACAL,MAAM,CAACI,GAAD,CAAN,CACD,CAND,EAMGE,OANH,CAMW,UAAM,CACf,KAAI,CAACV,WAAL,CAAmB,KAAnB,CACD,CARD,EASD,CAVM,CAAP,CAWD,C,qBAED,gBAAgB,CACd,KAAKA,WAAL,CAAmB,KAAnB,CACA,KAAKC,UAAL,CAAkB,IAAlB,CACD,C,8FAlCAX,U,4FAAsB,E,qEACtBA,U,4FAAkB,K,4EAClBA,U,4FAAyB,M,2EACzBA,U,4FAAwB,K,+DAExBC,M,0IAIAA,M,qIAIAA,M,mIAkBAA,M,uFAOH;AACA,cAAe,IAAII,CAAAA,UAAJ,EAAf","sourcesContent":["import React from 'react'\nimport {observable, action, makeObservable} from 'mobx'\nimport {Uploader} from '../models'\nimport {message} from 'antd'\n\nclass ImageStore {\n  constructor() {\n    makeObservable(this)\n  }\n\n  @observable filename = ''\n  @observable file = null\n  @observable isUploading = false\n  @observable serverFile = null\n\n  @action setFilename(newFilename) {\n    this.filename = newFilename\n  }\n\n  @action setFile(newFile) {\n    this.file = newFile\n  }\n\n  @action upload() {\n    this.isUploading = true\n    // 若上传失败，上传结果展示的还是上次的结果，会让人产生误会，所以每次上传都清空一下\n    this.serverFile = null\n\n    return new Promise((resolve, reject) => {\n      Uploader.add(this.file, this.filename).then(serverFile => {\n        this.serverFile = serverFile\n        resolve(serverFile)\n      }).catch(err => {\n        message.error('上传失败')\n        reject(err)\n      }).finally(() => {\n        this.isUploading = false\n      })\n    })\n  }\n\n  @action reset() {\n    this.isUploading = false\n    this.serverFile = null\n  }\n}\n\n\n// export { UserStore } 不能直接这么写，最好是直接导出一个对象\nexport default new ImageStore()\n"]},"metadata":{},"sourceType":"module"}